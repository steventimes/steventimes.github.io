---
import BaseLayout from "../layouts/BaseLayout.astro";
import Section from "../components/Section.astro";
import SkillPills from "../components/SkillPills.astro";
import Timeline from "../components/Timeline.astro";
import RepoCards from "../components/RepoCards.astro";
import CommandPalette from "../components/CommandPalette.astro";
import "../styles/global.css";
import { site } from "../data/site";
---

<BaseLayout title={`${site.name} — Personal Site`} description={site.tagline}>
  <header class="sticky top-0 z-40 backdrop-blur border-b border-black/5 dark:border-white/10 bg-white/70 dark:bg-slate-950/60">
    <nav class="max-w-5xl mx-auto px-5 h-16 flex items-center justify-between">
      <a href="#" class="font-semibold tracking-tight text-heading">{site.name}</a>

      <div class="hidden md:flex items-center gap-5 text-sm text-body">
        <a class="opacity-80 hover:opacity-100" href="#about">About</a>
        <a class="opacity-80 hover:opacity-100" href="#skills">Skills</a>
        <a class="opacity-80 hover:opacity-100" href="#experience">Experience</a>
        <a class="opacity-80 hover:opacity-100" href="#projects">Projects</a>
        <a class="opacity-80 hover:opacity-100" href="#repos">Repos</a>
        <a class="opacity-80 hover:opacity-100" href="#contact">Contact</a>
      </div>

      <div class="flex items-center gap-3">
        <button id="themeBtn" class="btn-outline text-sm px-3 py-1.5 rounded-full">
          Theme
        </button>
        <button class="btn-outline text-sm px-3 py-1.5 rounded-full"
          onclick="document.dispatchEvent(new KeyboardEvent('keydown',{key:'k',ctrlKey:true}))">
          Search
        </button>
      </div>
    </nav>
  </header>

  <!-- Hero -->
  <main class="max-w-5xl mx-auto px-5">
    <section class="pt-16 md:pt-20 pb-10">
      <div class="glass shadow-soft rounded-3xl p-8 md:p-10 overflow-hidden relative">
        <div class="absolute -top-24 -right-24 w-72 h-72 rounded-full blur-3xl opacity-40 bg-indigo-500 animate-floaty"></div>
        <div class="absolute -bottom-24 -left-24 w-72 h-72 rounded-full blur-3xl opacity-30 bg-emerald-500 animate-floaty"></div>

        <div class="relative grid gap-10 md:grid-cols-[1.1fr_0.9fr] items-center">
          <div>
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/70 dark:bg-white/10 text-xs uppercase tracking-widest border border-white/40 dark:border-white/10 text-heading">
              <span class="h-2 w-2 rounded-full bg-emerald-500"></span>
              B.S. Computer Science • Expected May 2027
            </div>
            <p class="mt-4 text-sm uppercase tracking-widest text-secondary">{site.location}</p>
            <h1 class="mt-3 text-3xl md:text-5xl font-semibold tracking-tight text-heading">
              {site.tagline}
            </h1>

            <p class="mt-5 text-body max-w-3xl leading-relaxed">
              {site.about[0]}
            </p>

            <div class="mt-6 flex flex-wrap gap-3">
              <a class="btn-primary px-4 py-2 rounded-full font-medium"
                 href="#contact">
                Contact
              </a>
              <a class="btn-outline px-4 py-2 rounded-full"
                 href={site.linkedin} target="_blank" rel="noreferrer">
                LinkedIn →
              </a>
              <a class="btn-outline px-4 py-2 rounded-full"
                 href={`https://github.com/${site.githubUsername}`} target="_blank" rel="noreferrer">
                GitHub →
              </a>
              <a class="btn-outline px-4 py-2 rounded-full"
                 href={site.resumePath} target="_blank" rel="noreferrer">
                Resume →
              </a>
            </div>

            <div class="mt-8 grid md:grid-cols-3 gap-4">
              {site.highlights.map((h) => (
                <div class="glass rounded-2xl p-4 border border-white/10">
                  <p class="text-xs uppercase tracking-widest text-secondary">{h.label}</p>
                  <p class="mt-1 font-semibold text-heading">{h.value}</p>
                </div>
              ))}
            </div>
          </div>

          <div class="flex flex-col gap-6">
            <div class="rounded-3xl overflow-hidden border border-white/20 dark:border-white/10 shadow-soft bg-white/10">
              <img
                src={site.photoPath}
                alt={`${site.name} headshot placeholder`}
                class="w-full h-80 object-cover"
                loading="lazy"
              />
            </div>
            <div class="grid gap-3">
              <div class="glass rounded-2xl p-4 border border-white/10">
                <p class="text-xs uppercase tracking-widest text-secondary">Signature</p>
                <p class="mt-1 font-semibold text-heading">System architecture, software engineering, and database systems.</p>
              </div>
            <div class="glass rounded-2xl p-4 border border-white/10">
                <p class="text-xs uppercase tracking-widest text-secondary">Currently</p>
                <p class="mt-1 font-semibold text-heading">RocksDB workload-aware tuning and data governance ETL.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Section id="about" title="About" kicker="who i am">
    <div class="grid md:grid-cols-2 gap-5">
      <div class="glass shadow-soft rounded-2xl p-6">
        <p class="leading-relaxed text-heading">
          {site.about.join(" ")}
        </p>
      </div>

      <div class="glass shadow-soft rounded-2xl p-6">
        <p class="font-semibold text-heading">Quick links</p>
        <div class="mt-4 grid gap-2 text-sm text-heading">
          <a class="underline opacity-80 hover:opacity-100" href={site.linkedin} target="_blank" rel="noreferrer">LinkedIn</a>
          <a class="underline opacity-80 hover:opacity-100" href={`https://github.com/${site.githubUsername}`} target="_blank" rel="noreferrer">GitHub</a>
          <a class="underline opacity-80 hover:opacity-100" href={site.resumePath} target="_blank" rel="noreferrer">Resume</a>
          <a class="underline opacity-80 hover:opacity-100" href={`mailto:${site.email}`}>Email</a>
        </div>
        <p class="mt-6 text-xs text-secondary">
          Tip: press <span class="px-2 py-1 rounded bg-black/5 dark:bg-white/10 border border-black/10 dark:border-white/10 text-heading">Ctrl K</span> for the command palette.
        </p>
      </div>
    </div>
  </Section>

  <Section id="skills" title="Skills" kicker="toolbox">
    <SkillPills skills={site.skills} />
  </Section>

  <Section id="experience" title="Experience" kicker="work & research">
    <Timeline items={site.experience} />
  </Section>

  <Section id="projects" title="Projects" kicker="selected work">
    <div class="grid md:grid-cols-2 gap-5">
      {site.projects.map((p) => (
        <div class="glass shadow-soft rounded-2xl p-6">
          <div class="flex items-start justify-between gap-4">
            <div>
              <p class="text-lg font-semibold text-heading">{p.name}</p>
              <p class="mt-2 text-body">{p.desc}</p>
            </div>
            {p.link && (
              <a class="text-sm underline opacity-80 hover:opacity-100 text-heading" href={p.link} target="_blank" rel="noreferrer">
                Link →
              </a>
            )}
          </div>
          <div class="mt-4 flex flex-wrap gap-2">
            {p.tech.map((t) => (
              <span class="text-xs px-2.5 py-1 rounded-full bg-black/5 dark:bg-white/10 border border-black/10 dark:border-white/10 text-heading">
                {t}
              </span>
            ))}
          </div>
        </div>
      ))}
    </div>
  </Section>

  <Section id="repos" title="GitHub Repos" kicker="proof of work">
    <RepoCards username={site.githubUsername} />
  </Section>

  <Section id="contact" title="Contact" kicker="say hi">
    <div class="glass shadow-soft rounded-2xl p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <p class="font-semibold text-lg text-heading">Let's talk</p>
        <p class="text-body mt-1">
          Email: <a class="underline text-body" href={`mailto:${site.email}`}>{site.email}</a>
        </p>
      </div>
      <div class="flex flex-wrap gap-3">
        <a class="btn-primary px-4 py-2 rounded-full font-medium"
           href={`mailto:${site.email}`}>
          Email
        </a>
        <a class="btn-outline px-4 py-2 rounded-full"
           href={site.linkedin} target="_blank" rel="noreferrer">
          LinkedIn
        </a>
        <a class="btn-outline px-4 py-2 rounded-full"
           href={`https://github.com/${site.githubUsername}`} target="_blank" rel="noreferrer">
          GitHub
        </a>
      </div>
    </div>

    <footer class="max-w-5xl mx-auto px-5 pb-12 pt-10 text-xs text-secondary">
      Built with Astro • Deployed on GitHub Pages • © {new Date().getFullYear()} {site.name}
    </footer>
  </Section>

  <CommandPalette items={[
    { label: "About", href: "#about" },
    { label: "Skills", href: "#skills" },
    { label: "Experience", href: "#experience" },
    { label: "Projects", href: "#projects" },
    { label: "GitHub Repos", href: "#repos" },
    { label: "Contact", href: "#contact" },
    { label: "LinkedIn", href: site.linkedin },
    { label: "GitHub", href: `https://github.com/${site.githubUsername}` },
    { label: "Email", href: `mailto:${site.email}` },
    { label: "Resume", href: site.resumePath }
  ]} />
</BaseLayout>
